DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'PlanDoneAPI.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202010272229075_PlanDoneApiMigration1'
BEGIN
    CREATE TABLE [dbo].[ListProperties] (
        [ListID] [nvarchar](128) NOT NULL,
        [Listname] [nvarchar](max),
        [CreatorID] [nvarchar](max),
        CONSTRAINT [PK_dbo.ListProperties] PRIMARY KEY ([ListID])
    )
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[TasksLists] (
        [TaskID] [nvarchar](128) NOT NULL,
        [ListID] [nvarchar](max),
        [Task] [nvarchar](max),
        [CreateDate] [datetime] NOT NULL,
        [AuthorID] [nvarchar](max),
        [Done] [bit] NOT NULL,
        [Priority] [int] NOT NULL,
        CONSTRAINT [PK_dbo.TasksLists] PRIMARY KEY ([TaskID])
    )
    CREATE TABLE [dbo].[UserListAccesses] (
        [AccessID] [nvarchar](128) NOT NULL,
        [ListID] [nvarchar](max),
        [UserID] [nvarchar](max),
        [AccessLevel] [int] NOT NULL,
        CONSTRAINT [PK_dbo.UserListAccesses] PRIMARY KEY ([AccessID])
    )
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202010272229075_PlanDoneApiMigration1', N'PlanDoneAPI.Migrations.Configuration',  0x1F8B0800000000000400DD5D5B6FE3B8157E2FD0FF20F8A92DB2762E9DC1347076E17592ADD1C409C69945DF06B4443BC2489457A2B2498BFD657DE84FEA5F28295117DE2451922D67B15820E6E59CC3C38F8787D4399CFFFDE7BFD31F5E7DCF7A8161E406E86A74363E1D5910D981E3A2EDD528C69BEF3E8D7EF8FE8F7F98DE38FEABF573D6EE82B6233D5174357AC67877399944F633F44134F65D3B0CA26083C776E04F80134CCE4F4FFF36393B9B404262446859D6F4738CB0EBC3E407F9390F900D773806DE7DE0402F62E5A4669550B596C087D10ED8F06AF4E801741D20387B5C8CD3D6236BE6B98048B282DE66640184020C3091F3F24B0457380CD076B52305C07B7ADB41D26E03BC0832F92F8BE64D87727A4E8732293A66A4EC38C2816F48F0EC82E96622766FA5E151AE3BA2BD1BA265FC46479D68F06A74E746F8310C7630C42E248A13595ECEBD903657A979CC773EB14A4D4E72681004D1FF4EAC79ECE138845708C638041E691EAF3DD7FE077C7B0ABE41748562CF2B0B4BC425755C012962FCDE3EC34D69088BEB9135E1FB4EC4CE7957A15F3A3C020B82F091750F5EEF20DAE26782FDF34F23EBD67D854E56C270F205B96441904E388CC9CF25111CAC3D98D74F6AF922F2570567F26723CED58CE6210438082BC7D886D37452C0A8125C0B0726459F030F5641EB3EC7EF2CDA2D211E671DC729C9DB9090FB3508BF8DCB144FACC6FD0A349E3745E3C5D97A73F1E9C347E05C7CFC2BBCF8D006990BC71C95B4CFA111B9AC46E3F9878FBD705D8217779B4CBDC09F58E590D89ECFD04B6AA3677797DA6E6EBEBFB266B761E0D3DF3CBED2DAAFAB200E6D3A9840DBE409845B883B429A92EA1FD619D5E38736955486B7B2291D509B9590B138F46AC8E4DD2FDFC6887B02D1B788EE19869B73DE6FA87D990AD0665FCEFA0DB12FF7BE57AA877798AD1F5E93FF3356F4EF27D73757CB2CC6CF7B7022644614A119931F03B208013216F631748390AC9F8CCE02E18BF3BE56223548142433DB8691A9AFCC771E6A4DA6DCDBACCAA2E7EF745D26DBCDFED9A47ABC832FD0DB0B4867BB1D014A82473A2243940ABD8782E97B719C6F7CE07A3D78CE0DB8CC03B471431F3A9D4D248822E2383A7F07D1F3DED1BE82764CEDF10A037FB7776E8FCF04A9CBD85F53DC1F8E576F53F3F46B700B6C7264BF41B457677A7781FD2D88F10D72E8EEFF05DBB233D090402FE2A4A6EF9680193AF32046D8C400AA0DF6D027D7B9075C5F7D74154CE9D7AC69717C55B7908EB09A66AA636C95A877C1D645CD44CD9AEA454D5BD48ACA9A998A4A89359394B5D40B9A34A895336DD5DBC5403243FDDF0C24648FFF6AA0DBE6ADB3052535AE8885843F41044362C69C4780310C5131038D1CBD019C8564FA28D3FD9FFE28A79F8117F7CDAAD56A488C40FFAB21217BFCAB21119314BFB80EF54A1ADC97658D09F946EDD557710DBE7FF0921D7A3970C33C34F3C3D800DD7299455160BBC92A507C2961F7DCBCFCC487B3EA2FBDD3D18817E7646004E82EDDF2480919DB4804D503BA861EC4D09AD9E967CA39886CE0C86A2403720C04CB76548560C5053A2FDC5F249E04E930A49D003D044564A5BA08CBCBC245B6BB035EAD96849E0DB7303AF69C8758730D77105186B59A68C25C7D5F4E05C8F9089352A7A1E9A484B86A206ABC56DD9CD7B9B0C5BC4BF71207C1648DEFACC125F3DFF602CC6A8D1D009CD52A692280F6DBCF1000656795A600100F2EC70650E1C4A4012873A90E02505E6303009457C9BB03687A446D3AFFC279F5D8E0C91F940FBFAD57AA6B006C72FA383268A6BE27E983490F18CAF0BC5ED34AF8AAFAB24CE464E7B388B9BA224428F115C49A38B2C2F16500111B4CAAE9B18B1D890CEFD7D61011415945B0006E0DD1FCBBBA8A5AE9637D0D19FE7BA05234F17B63038A2A3292E530D05A766959A936E62E1990CD2E182BC9B24D4E205B02BB4CBB1C26546AA80F26125761A363563EB21CA6D26A6E742A2AD1512055B4D2FCC01B284577012D2BA689D36FE2F69706C626A34241352EBA4649D9607AD75206CD7A2DA93C4F13DFB39396043F51A3A56C30BD6B8961B45E490AEFC7C0FFE9A422DE57E969B165573AF9B69AD74D2769683A2B984E3431ECD37BB0DBB9685B8A696725D62A0D689F7FB7328FF4F6531A133B52047CE7D2E69C7010822D146A096B22E9AD1B46F81A60B006F4426BEEF85233A513A131FF194BA59F20CF66B62164DDE8DFECC2B02E005DE180312AB764B03EF5E2924F072528D411B068C201F040A8894999075EECA3AA38F43A2A6924B848272D6D4EA914EA5D26552A96694D2782762497549A0DE9E0C0CF712304E82C82D1C4736EA0F9B45777D72999FAED65EDAAFC787DEFA534D14BCD240F3431B259EC699272D7BAFD44E949E8D49D1DB4CA0AD71DBEF454B2BBD83215DDFDEC6013573A91749CB1E2F8623E55157D75DACD227DCBDA55470D5751E9C716A761B9A224C63698C5DC4A46989537A75684DD966915A5CD29A571B5652A6949730A45546D994A517A342B413A54775C0FC209DC7C51D411D0CE7E1E6DCBCDBE267AB78A523FAB230B8E95ACA911152EF6551E18AB382A3475869078FB628EA15A0AFBF157586C6B99002B32A4510A8F948895EA0CCC1117C1CA9924AEA63945214CB54C52A83290B21C8CCA0959AE68454FA351750B832D500A3FE5B643A9D6C008C981A89C3D92AB5BD056C82CD6999A2A2E565536585CB59931954F0345E9D11840C5855B8F4782F4DAB8DB994043633F16B19F2345290C90F3128B62435A2CD04F22C6CA8F124DDABBD3D6684ABF167443938686DEF2700174BCE1A98CFAD3D3E4A2E2786FBB222A504FCF0CB37B458674752A36C9B9E757A8C255E9945D5BD6BF0922DD63A64D4656A646B2B1BF4518FA63DA60BCFAC59B7B2EA4663C6B700F90BB81114E234147E7A767E7E3D9BFE2100A8F8B1CCF431F9328723CC5E5AFFEB50F7EEE0EF8D8067A01A1FD0C4239E4B2E35B1A19E13FF9E0F5CF656AADDECB30A0D6EE4D8C1613D02DBABE37C52F154A5784112C90035FAF46FF4E7A5D261F6AE85F49F189B588BE20F79798543C11855ABFC9B93BFDE4443678B42117F4B777F11A4273952FFEF935ED7A623D84C4AE5D5AA782A2DB4C3FFF4682913469D70ED2B47839A1C594F6F37A41AF86AE9561524BD89FBDE41E1970C8DFB88F47063AC9557E4860EDE2CE8F08B8A88E46DB27045AE0B2BF0CFE63C4269F84DF899422D1BEC789ACBC947B573B3997C3AEA42AECC4ED53D65B2D4645BA7A275C2853D23B5154A49DF745AF1715EAD2CADBD0D2A694AB4C7F93C1AA53CCDB88A64D2FAF5FF66A43D4CEC7CD7A0EE8E32A6EC50E6192123DD726E776CAD41BDAEF957278BB3950529EEE3E4F9C55B9B8DD8E3FEF2CC7B5B7AD5391C2DA1BED2171BFF7BCD56349552D2E0486CD503D64526A4534D6EF2A17F508B2A7144912C3679C1E1A6BBACF7C479EB66796577A646063DBFCF0D9A387069BEE2BE09183CD2847F4C8B036D4FE3930D21A6FA183677CCA391DE2B4F2897AC6A99CE9B7D5AB91B30E081052AFD230DD93F701258E7CB58A5FFAF88F3A9B47C7AC00A89661D144CF549F4624322E65874A1C4B752A56E5AC53A3CCD20679A52A7E727A6A0D57C910496CA516D52A359B47E640554E246B53CD56935858C59BEDA795BC599B6ADE9A74BD21525E950973AAFCE89A7D411369A3CCB43EE614576E243519D5756780CA58B6F794D1DA8B52B8D5A309C97A3F09ACBDA8A4CFA56390B02A4757115FA4F4EF32117F2872B70509FAAF342168735E48DE66813641E60C0912654D841BAF7B8881435C9419711936C0A6EE03DD7B9297D9924B52FA59690D9D057A88F12EC664C8D05F7BDC052275AAAAF82759B9BCCCD3871DFD15F5310422A64B3F843CA01F63D77372B96F15776C1A12D45B63D7E7742E31BD46DFBEE5949652EA8E8E10535FEE643E417FE71162D1035A8117D8463602BF3BB805F65B71A3AA23523F11BCDAA7D72ED886C08F188DA23FF94930ECF8AFDFFF1F442D1EA59E6C0000 , N'6.2.0-61023')
END

